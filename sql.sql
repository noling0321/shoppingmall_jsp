CREATE SEQUENCE SALES_SEQ
INCREMENT BY 1
START WITH 16;

INSERT INTO "SDH11"."PRODUCT" (PRODUCT_ID, NAME, PRICE, CATEGORY_ID) VALUES ('2', '태블릿 PC', '800000', '1');
INSERT INTO "SDH11"."PRODUCT" (PRODUCT_ID, NAME, PRICE, CATEGORY_ID) VALUES ('1', '컴퓨터', '1000000', '1');
INSERT INTO "SDH11"."PRODUCT" (PRODUCT_ID, NAME, PRICE, CATEGORY_ID) VALUES ('3', '핸드폰', '1200000', '1');
INSERT INTO "SDH11"."PRODUCT" (PRODUCT_ID, NAME, PRICE, CATEGORY_ID) VALUES ('4', '헤드셋', '80000', '1');
INSERT INTO "SDH11"."PRODUCT" (PRODUCT_ID, NAME, PRICE, CATEGORY_ID) VALUES ('5', '무선 이어폰', '210000', '1');
INSERT INTO "SDH11"."PRODUCT" (PRODUCT_ID, NAME, PRICE, CATEGORY_ID) VALUES ('6', '책상', '160000', '2');
INSERT INTO "SDH11"."PRODUCT" (PRODUCT_ID, NAME, PRICE, CATEGORY_ID) VALUES ('7', '의자', '90000', '2');
INSERT INTO "SDH11"."PRODUCT" (PRODUCT_ID, NAME, PRICE, CATEGORY_ID) VALUES ('8', '소고기', '12000', '3');
INSERT INTO "SDH11"."PRODUCT" (PRODUCT_ID, NAME, PRICE, CATEGORY_ID) VALUES ('9', '티셔츠', '58000', '4');



INSERT INTO "SDH11"."CATEGORY" (CATEGORY_ID, NAME) VALUES ('1', '전자제품')
INSERT INTO "SDH11"."CATEGORY" (CATEGORY_ID, NAME) VALUES ('2', '가구')
INSERT INTO "SDH11"."CATEGORY" (CATEGORY_ID, NAME) VALUES ('3', '식품')
INSERT INTO "SDH11"."CATEGORY" (CATEGORY_ID, NAME) VALUES ('4', '의류')



INSERT INTO "SDH11"."SALE" (SALE_ID, PRODUCT_ID, PURCHASE_DATE, SALE_PRICE, AMOUNT) VALUES ('1', '1', TO_DATE('2020-01-01 14:45:22', 'YYYY-MM-DD HH24:MI:SS'), '1000000', '1')
INSERT INTO "SDH11"."SALE" (SALE_ID, PRODUCT_ID, PURCHASE_DATE, SALE_PRICE, AMOUNT) VALUES ('2', '2', TO_DATE('2020-01-01 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), '1600000', '2')
INSERT INTO "SDH11"."SALE" (SALE_ID, PRODUCT_ID, PURCHASE_DATE, SALE_PRICE, AMOUNT) VALUES ('3', '1', TO_DATE('2020-01-01 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), '2000000', '2')
INSERT INTO "SDH11"."SALE" (SALE_ID, PRODUCT_ID, PURCHASE_DATE, SALE_PRICE, AMOUNT) VALUES ('4', '4', TO_DATE('2020-01-02 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), '240000', '3')
INSERT INTO "SDH11"."SALE" (SALE_ID, PRODUCT_ID, PURCHASE_DATE, SALE_PRICE, AMOUNT) VALUES ('5', '5', TO_DATE('2020-01-04 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), '210000', '1')
INSERT INTO "SDH11"."SALE" (SALE_ID, PRODUCT_ID, PURCHASE_DATE, SALE_PRICE, AMOUNT) VALUES ('6', '6', TO_DATE('2020-01-06 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), '320000', '2')
INSERT INTO "SDH11"."SALE" (SALE_ID, PRODUCT_ID, PURCHASE_DATE, SALE_PRICE, AMOUNT) VALUES ('7', '7', TO_DATE('2020-01-11 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), '360000', '4')
INSERT INTO "SDH11"."SALE" (SALE_ID, PRODUCT_ID, PURCHASE_DATE, SALE_PRICE, AMOUNT) VALUES ('8', '8', TO_DATE('2020-01-15 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), '60000', '5')
INSERT INTO "SDH11"."SALE" (SALE_ID, PRODUCT_ID, PURCHASE_DATE, SALE_PRICE, AMOUNT) VALUES ('9', '9', TO_DATE('2020-01-17 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), '58000', '1')
INSERT INTO "SDH11"."SALE" (SALE_ID, PRODUCT_ID, PURCHASE_DATE, SALE_PRICE, AMOUNT) VALUES ('10', '9', TO_DATE('2020-01-20 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), '580000', '10')
INSERT INTO "SDH11"."SALE" (SALE_ID, PRODUCT_ID, PURCHASE_DATE, SALE_PRICE, AMOUNT) VALUES ('11', '2', TO_DATE('2020-01-21 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), '1600000', '2')
INSERT INTO "SDH11"."SALE" (SALE_ID, PRODUCT_ID, PURCHASE_DATE, SALE_PRICE, AMOUNT) VALUES ('12', '1', TO_DATE('2020-01-22 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), '1000000', '1')
INSERT INTO "SDH11"."SALE" (SALE_ID, PRODUCT_ID, PURCHASE_DATE, SALE_PRICE, AMOUNT) VALUES ('13', '4', TO_DATE('2020-01-24 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), '80000', '1')
INSERT INTO "SDH11"."SALE" (SALE_ID, PRODUCT_ID, PURCHASE_DATE, SALE_PRICE, AMOUNT) VALUES ('14', '5', TO_DATE('2020-01-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), '210000', '1')
INSERT INTO "SDH11"."SALE" (SALE_ID, PRODUCT_ID, PURCHASE_DATE, SALE_PRICE, AMOUNT) VALUES ('15', '6', TO_DATE('2020-01-29 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), '160000', '1')



SELECT SALE.SALE_ID SALE_ID, PRODUCT.NAME PRODUCT_NAME, SALE.PURCHASE_DATE PURCHASE_DATE, 
sale.sale_price TOTAL_SALES, sale.amount SALE_AMOUNT
FROM SALE, PRODUCT
WHERE SALE.PRODUCT_ID = product.product_id
ORDER BY sale.sale_id ASC;



SELECT product.name, SUM(sale.sale_price), SUM(sale.amount)
FROM sale, product
WHERE product.product_id = sale.product_id
GROUP BY product.name, product.product_id;



SELECT category.name, SUM(sale.sale_price), SUM(sale.amount)
FROM category, sale, product
WHERE product.product_id = sale.product_id AND product.category_id = category.category_id
GROUP BY category.category_id, category.name
ORDER BY category.category_id ASC;



SELECT product.name, product.product_id FROM product 
GROUP BY product.name, product.product_id
ORDER BY product.product_id ASC;